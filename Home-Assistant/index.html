<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Everything about using Tasmota in Home Assistant"><link href=https://tasmota.github.io/docs/Home-Assistant/ rel=canonical><link rel="shortcut icon" href=../_media/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.8"><title>Home Assistant - Tasmota</title><link rel=stylesheet href=../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../assets/stylesheets/palette.39b8e14a.min.css><meta name=theme-color content=#2094f3><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Barlow",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-140681905-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=blue data-md-color-accent=indigo> <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#home-assistant class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://tasmota.github.io/docs/ title=Tasmota class="md-header-nav__button md-logo" aria-label=Tasmota> <img src=../_media/logo.svg alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Tasmota </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Home Assistant </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/arendst/tasmota/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../About/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../Getting-Started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../Upgrading/ class=md-tabs__link> Upgrading </a> </li> <li class=md-tabs__item> <a href=../MQTT/ class=md-tabs__link> MQTT </a> </li> <li class=md-tabs__item> <a href=../Commands/ class=md-tabs__link> Commands </a> </li> <li class=md-tabs__item> <a href=../Templates/ class=md-tabs__link> Templates </a> </li> <li class=md-tabs__item> <a href=../Components/ class=md-tabs__link> Components </a> </li> <li class=md-tabs__item> <a href=../Modules/ class=md-tabs__link> Modules </a> </li> <li class=md-tabs__item> <a href=../Peripherals/ class=md-tabs__link> Peripherals </a> </li> <li class=md-tabs__item> <a href=../WebUI/ class=md-tabs__link> WebUI </a> </li> <li class=md-tabs__item> <a href=../Features/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class="md-tabs__link md-tabs__link--active"> Smart Home Integrations </a> </li> <li class=md-tabs__item> <a href=../Supported-Peripherals/ class=md-tabs__link> Peripherals </a> </li> <li class=md-tabs__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../FAQ/ class=md-tabs__link> Help </a> </li> <li class=md-tabs__item> <a href=../Builds/ class=md-tabs__link> Builds </a> </li> <li class=md-tabs__item> <a href=../Compile-your-build/ class=md-tabs__link> Compiling </a> </li> <li class=md-tabs__item> <a href=../Contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href="http://ota.tasmota.com/tasmota/release/ " target='_blank""' class=md-tabs__link> Download </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://tasmota.github.io/docs/ title=Tasmota class="md-nav__button md-logo" aria-label=Tasmota> <img src=../_media/logo.svg alt=logo> </a> Tasmota </label> <div class=md-nav__source> <a href=https://github.com/arendst/tasmota/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../Upgrading/ class=md-nav__link> Upgrading </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> MQTT </a> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../Templates/ class=md-nav__link> Templates </a> </li> <li class=md-nav__item> <a href=../Components/ class=md-nav__link> Components </a> </li> <li class=md-nav__item> <a href=../Modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../Peripherals/ class=md-nav__link> Peripherals </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> WebUI </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-12 type=checkbox id=nav-12> <label class=md-nav__link for=nav-12> Features <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Features data-md-level=1> <label class=md-nav__title for=nav-12> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Features/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../ble/Bluetooth-Esp32/ class=md-nav__link> Bluetooth ESP32 </a> </li> <li class=md-nav__item> <a href=../ble/Bluetooth-Esp8266/ class=md-nav__link> Bluetooth ESP8266 </a> </li> <li class=md-nav__item> <a href=../Buttons-and-Switches/ class=md-nav__link> Buttons and Switches </a> </li> <li class=md-nav__item> <a href=../DeepSleep/ class=md-nav__link> DeepSleep </a> </li> <li class=md-nav__item> <a href=../Device-Groups/ class=md-nav__link> Device Groups </a> </li> <li class=md-nav__item> <a href=../Dynamic-Sleep/ class=md-nav__link> Dynamic Sleep </a> </li> <li class=md-nav__item> <a href=../I2CDevices/ class=md-nav__link> I2C Devices </a> </li> <li class=md-nav__item> <a href=../Tasmota-IR/ class=md-nav__link> IR Communication </a> </li> <li class=md-nav__item> <a href=../Lights/ class=md-nav__link> Lights </a> </li> <li class=md-nav__item> <a href=../OpenTherm/ class=md-nav__link> OpenTherm </a> </li> <li class=md-nav__item> <a href=../PIR-Motion-Sensors/ class=md-nav__link> PIR Motion Sensors </a> </li> <li class=md-nav__item> <a href=../Power-Monitoring-Calibration/ class=md-nav__link> Power Monitoring Calibration </a> </li> <li class=md-nav__item> <a href=../PWM-dimmer-switch/ class=md-nav__link> PWM Dimmer </a> </li> <li class=md-nav__item> <a href=../RF-Protocol/ class=md-nav__link> RF 433MHz Protocol </a> </li> <li class=md-nav__item> <a href=../Rules/ class=md-nav__link> Rules </a> </li> <li class=md-nav__item> <a href=../Scripting-Language/ class=md-nav__link> Scripting </a> </li> <li class=md-nav__item> <a href=../Serial-to-TCP-Bridge/ class=md-nav__link> Serial to TCP Bridge </a> </li> <li class=md-nav__item> <a href=../Blinds-and-Shutters/ class=md-nav__link> Shutters and Blinds </a> </li> <li class=md-nav__item> <a href=../Smart-Meter-Interface/ class=md-nav__link> Smart Meter Interface </a> </li> <li class=md-nav__item> <a href=../Subscribe-%26-Unsubscribe/ class=md-nav__link> Subscribe & Unsubscribe </a> </li> <li class=md-nav__item> <a href=../TasmotaClient/ class=md-nav__link> TasmotaClient </a> </li> <li class=md-nav__item> <a href=../Thermostat/ class=md-nav__link> Thermostat </a> </li> <li class=md-nav__item> <a href=../Timers/ class=md-nav__link> Timers </a> </li> <li class=md-nav__item> <a href=../TLS/ class=md-nav__link> TLS Secured MQTT </a> </li> <li class=md-nav__item> <a href=../TuyaMCU/ class=md-nav__link> TuyaMCU </a> </li> <li class=md-nav__item> <a href=../Zigbee/ class=md-nav__link> Zigbee </a> </li> <li class=md-nav__item> <a href=../Tutorials/ class=md-nav__link> Projects and Tutorials </a> </li> <li class=md-nav__item> <a href=../For-Developers/ class=md-nav__link> For Developers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-13 type=checkbox id=nav-13 checked> <label class=md-nav__link for=nav-13> Smart Home Integrations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Smart Home Integrations" data-md-level=1> <label class=md-nav__title for=nav-13> <span class="md-nav__icon md-icon"></span> Smart Home Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../Alexa/ class=md-nav__link> Alexa </a> </li> <li class=md-nav__item> <a href=../AWS-IoT/ class=md-nav__link> AWS IoT </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> Domoticz </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Home Assistant <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Home Assistant </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#tasmota-beta-integration class=md-nav__link> Tasmota (beta) Integration </a> <nav class=md-nav aria-label="Tasmota (beta) Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#supported-entities class=md-nav__link> Supported Entities </a> </li> <li class=md-nav__item> <a href=#transition-from-mqtt-discovery class=md-nav__link> Transition from MQTT Discovery </a> </li> <li class=md-nav__item> <a href=#removing-devices class=md-nav__link> Removing devices </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#editing-configurationyaml class=md-nav__link> Editing configuration.yaml </a> <nav class=md-nav aria-label="Editing configuration.yaml"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#switches class=md-nav__link> Switches </a> </li> <li class=md-nav__item> <a href=#lights class=md-nav__link> Lights </a> </li> <li class=md-nav__item> <a href=#sensors class=md-nav__link> Sensors </a> </li> <li class=md-nav__item> <a href=#power-monitoring class=md-nav__link> Power Monitoring </a> </li> <li class=md-nav__item> <a href=#binary-sensors class=md-nav__link> Binary Sensors </a> </li> <li class=md-nav__item> <a href=#fans class=md-nav__link> Fans </a> </li> <li class=md-nav__item> <a href=#covers class=md-nav__link> Covers </a> </li> <li class=md-nav__item> <a href=#device-specific class=md-nav__link> Device Specific </a> </li> <li class=md-nav__item> <a href=#zigbee-devices class=md-nav__link> Zigbee Devices </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#useful-automations class=md-nav__link> Useful Automations </a> </li> <li class=md-nav__item> <a href=#mqtt-discovery class=md-nav__link> MQTT Discovery </a> <nav class=md-nav aria-label="MQTT Discovery"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enable-autodiscovery class=md-nav__link> Enable Autodiscovery </a> </li> <li class=md-nav__item> <a href=#finalising-setup class=md-nav__link> Finalising Setup </a> </li> <li class=md-nav__item> <a href=#supported-entities_1 class=md-nav__link> Supported Entities </a> </li> <li class=md-nav__item> <a href=#disabling class=md-nav__link> Disabling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Homebridge/ class=md-nav__link> Homebridge </a> </li> <li class=md-nav__item> <a href=../HomeSeer/ class=md-nav__link> HomeSeer </a> </li> <li class=md-nav__item> <a href=../IP-Symcon/ class=md-nav__link> IP Symcon </a> </li> <li class=md-nav__item> <a href=../KNX/ class=md-nav__link> KNX </a> </li> <li class=md-nav__item> <a href=../NodeRed/ class=md-nav__link> NodeRed </a> </li> <li class=md-nav__item> <a href=../nymea/ class=md-nav__link> nymea </a> </li> <li class=md-nav__item> <a href=../Octoprint/ class=md-nav__link> OctoPrint </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> openHAB </a> </li> <li class=md-nav__item> <a href=../otto/ class=md-nav__link> Otto </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/issues/3769 class=md-nav__link> IOBroker </a> </li> <li class=md-nav__item> <a href=https://github.com/tim-hellhake/tasmota-adapter class=md-nav__link> Mozilla WebThings Adapter </a> </li> <li class=md-nav__item> <a href=https://github.com/hongtat/tasmota-connect class=md-nav__link> SmartThings </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-14 type=checkbox id=nav-14> <label class=md-nav__link for=nav-14> Peripherals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Peripherals data-md-level=1> <label class=md-nav__title for=nav-14> <span class="md-nav__icon md-icon"></span> Peripherals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Supported-Peripherals/ class=md-nav__link> Supported Peripherals </a> </li> <li class=md-nav__item> <a href=../ADC/ class=md-nav__link> Analog pin </a> </li> <li class=md-nav__item> <a href=../Buzzer/ class=md-nav__link> Buzzer </a> </li> <li class=md-nav__item> <a href=../Displays/ class=md-nav__link> Displays </a> </li> <li class=md-nav__item> <a href=../ESP32/ class=md-nav__link> ESP32 Support (Beta development) </a> </li> <li class=md-nav__item> <a href=../A4988-Stepper-Motor-Controller/ class=md-nav__link> A4988 stepper motor controller </a> </li> <li class=md-nav__item> <a href=../AHT1x/ class=md-nav__link> AHT1x temperature and humidity sensor </a> </li> <li class=md-nav__item> <a href=../AM2301/ class=md-nav__link> AM2301 temperature and humidity sensor </a> </li> <li class=md-nav__item> <a href=../APDS-9960/ class=md-nav__link> APDS-9960 light and gesture sensor </a> </li> <li class=md-nav__item> <a href=../AS3935/ class=md-nav__link> AS3935 Franklin Lightning sensor </a> </li> <li class=md-nav__item> <a href=../AZ-7798/ class=md-nav__link> AZ7798 CO<sub>2</sub> meter </a> </li> <li class=md-nav__item> <a href=../BH1750/ class=md-nav__link> BH1750 ambient light sensor </a> </li> <li class=md-nav__item> <a href=../BME280/ class=md-nav__link> BME280 temperature, humidity and pressure sensor </a> </li> <li class=md-nav__item> <a href=../BME680/ class=md-nav__link> BME680 temperature, humidity, pressure and gas sensor </a> </li> <li class=md-nav__item> <a href=../CC2530/ class=md-nav__link> CC253x Zigbee module </a> </li> <li class=md-nav__item> <a href=../Moisture-Sensor-and-Chirp%21-Sensor/ class=md-nav__link> Chirp! moisture sensor </a> </li> <li class=md-nav__item> <a href=../DHT11/ class=md-nav__link> DHT11 temperature and humidity sensor </a> </li> <li class=md-nav__item> <a href=../DS18x20/ class=md-nav__link> DS18x20 temperature sensor </a> </li> <li class=md-nav__item> <a href=../DS3231/ class=md-nav__link> DS3231 Real Time Clock </a> </li> <li class=md-nav__item> <a href=../EZO/ class=md-nav__link> EZO sensors </a> </li> <li class=md-nav__item> <a href=../HM-10/ class=md-nav__link> HM-10 Bluetooth module </a> </li> <li class=md-nav__item> <a href=../HM-17/ class=md-nav__link> HM-17 Bluetooth module </a> </li> <li class=md-nav__item> <a href=../HC-SR04/ class=md-nav__link> HC-SR04 ultrasonic ranging sensor </a> </li> <li class=md-nav__item> <a href=../Honeywell-HIH/ class=md-nav__link> Honeywell HIH temperature and humidity sensor </a> </li> <li class=md-nav__item> <a href=../IAQ/ class=md-nav__link> iAQ-Core indoor air quality sensor </a> </li> <li class=md-nav__item> <a href=../IR-Remote/ class=md-nav__link> IR Remote </a> </li> <li class=md-nav__item> <a href=../LM75AD/ class=md-nav__link> LM75AD temperature sensor </a> </li> <li class=md-nav__item> <a href=../MCP230xx/ class=md-nav__link> MCP23008 / MCP23017 GPIO Expander </a> </li> <li class=md-nav__item> <a href=../MGC3130/ class=md-nav__link> MGC3130 3D tracking and gesture controller </a> </li> <li class=md-nav__item> <a href=../MH-Z19B/ class=md-nav__link> MH-Z19B CO<sub>2</sub> Sensor </a> </li> <li class=md-nav__item> <a href=../MLX90614/ class=md-nav__link> MLX90614 infrared thermometer </a> </li> <li class=md-nav__item> <a href=../MLX90640/ class=md-nav__link> MLX90640 Far infrared thermal sensor array </a> </li> <li class=md-nav__item> <a href=../MPR121/ class=md-nav__link> MPR121 capacitive touch sensor </a> </li> <li class=md-nav__item> <a href=../MPU-6050/ class=md-nav__link> MPU-6050 gyroscope and accelerometer </a> </li> <li class=md-nav__item> <a href=../NRF24L01/ class=md-nav__link> NRF24L01 module </a> </li> <li class=md-nav__item> <a href=../OpenTherm/ class=md-nav__link> OpenTherm </a> </li> <li class=md-nav__item> <a href=../P1-Smart-Meter/ class=md-nav__link> P1 Smart Meter </a> </li> <li class=md-nav__item> <a href=../PAJ7620/ class=md-nav__link> PAJ7620U2 gesture sensor </a> </li> <li class=md-nav__item> <a href=../PCA9685/ class=md-nav__link> PCA9685 12-bit PWM controller </a> </li> <li class=md-nav__item> <a href=../PN532/ class=md-nav__link> PN532 NFC reader </a> </li> <li class=md-nav__item> <a href=../PZEM-0XX/ class=md-nav__link> PZEM-0xx power monitor </a> </li> <li class=md-nav__item> <a href=../RCWL-0516/ class=md-nav__link> RCWL-0516 microwave radar motion sensor </a> </li> <li class=md-nav__item> <a href=../RDM6300/ class=md-nav__link> RDM6300 RFID reader </a> </li> <li class=md-nav__item> <a href=../RF-Transciever/ class=md-nav__link> RF Transciever </a> </li> <li class=md-nav__item> <a href=../SDS011/ class=md-nav__link> SDS011 air quality sensor </a> </li> <li class=md-nav__item> <a href=../SHT30/ class=md-nav__link> SHT30 temperature sensor </a> </li> <li class=md-nav__item> <a href=../TX2x/ class=md-nav__link> TX20/TX23 anemometer </a> </li> <li class=md-nav__item> <a href=../TSL2561/ class=md-nav__link> TSL2561 light sensor </a> </li> <li class=md-nav__item> <a href=../VEML6070/ class=md-nav__link> VEML6070 UV light sensor </a> </li> <li class=md-nav__item> <a href=../VEML6075/ class=md-nav__link> VEML6075 UVA/UVB/UVINDEX Sensor </a> </li> <li class=md-nav__item> <a href=../VEML7700/ class=md-nav__link> VEML7700 Ambient light sensor </a> </li> <li class=md-nav__item> <a href=../VL53L0x/ class=md-nav__link> VL53L0X laser ranging module </a> </li> <li class=md-nav__item> <a href=../WS2812B-RGB-Shield/ class=md-nav__link> WS2812B RGB Shield </a> </li> <li class=md-nav__item> <a href=../WS2812B-and-WS2813/ class=md-nav__link> WS2812B and WS2813 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-15 type=checkbox id=nav-15> <label class=md-nav__link for=nav-15> Supported Devices <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Supported Devices" data-md-level=1> <label class=md-nav__title for=nav-15> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-nav__link> Configure Unknown Device </a> </li> <li class=md-nav__item> <a href="https://templates.blakadder.com/ " target='_blank""' class=md-nav__link> All Supported Devices </a> </li> <li class=md-nav__item> <a href=../Pinouts/ class=md-nav__link> Wi-Fi Module Pinouts </a> </li> <li class=md-nav__item> <a href=../Supported-Modules/ class=md-nav__link> Supported Modules </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-16 type=checkbox id=nav-16> <label class=md-nav__link for=nav-16> Help <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Help data-md-level=1> <label class=md-nav__title for=nav-16> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../Device-Recovery/ class=md-nav__link> Device Recovery </a> </li> <li class=md-nav__item> <a href="https://discord.gg/Ks2Kzd4 " target='_blank""' class=md-nav__link> Discord Support </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Builds/ class=md-nav__link> Builds </a> </li> <li class=md-nav__item> <a href=../Compile-your-build/ class=md-nav__link> Compiling </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href="http://ota.tasmota.com/tasmota/release/ " target='_blank""' class=md-nav__link> Download </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#tasmota-beta-integration class=md-nav__link> Tasmota (beta) Integration </a> <nav class=md-nav aria-label="Tasmota (beta) Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#supported-entities class=md-nav__link> Supported Entities </a> </li> <li class=md-nav__item> <a href=#transition-from-mqtt-discovery class=md-nav__link> Transition from MQTT Discovery </a> </li> <li class=md-nav__item> <a href=#removing-devices class=md-nav__link> Removing devices </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#editing-configurationyaml class=md-nav__link> Editing configuration.yaml </a> <nav class=md-nav aria-label="Editing configuration.yaml"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#switches class=md-nav__link> Switches </a> </li> <li class=md-nav__item> <a href=#lights class=md-nav__link> Lights </a> </li> <li class=md-nav__item> <a href=#sensors class=md-nav__link> Sensors </a> </li> <li class=md-nav__item> <a href=#power-monitoring class=md-nav__link> Power Monitoring </a> </li> <li class=md-nav__item> <a href=#binary-sensors class=md-nav__link> Binary Sensors </a> </li> <li class=md-nav__item> <a href=#fans class=md-nav__link> Fans </a> </li> <li class=md-nav__item> <a href=#covers class=md-nav__link> Covers </a> </li> <li class=md-nav__item> <a href=#device-specific class=md-nav__link> Device Specific </a> </li> <li class=md-nav__item> <a href=#zigbee-devices class=md-nav__link> Zigbee Devices </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#useful-automations class=md-nav__link> Useful Automations </a> </li> <li class=md-nav__item> <a href=#mqtt-discovery class=md-nav__link> MQTT Discovery </a> <nav class=md-nav aria-label="MQTT Discovery"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enable-autodiscovery class=md-nav__link> Enable Autodiscovery </a> </li> <li class=md-nav__item> <a href=#finalising-setup class=md-nav__link> Finalising Setup </a> </li> <li class=md-nav__item> <a href=#supported-entities_1 class=md-nav__link> Supported Entities </a> </li> <li class=md-nav__item> <a href=#disabling class=md-nav__link> Disabling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/tasmota/docs/blob/master/docs/Home-Assistant.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=home-assistant>Home Assistant<a class=headerlink href=#home-assistant title="Permanent link">~</a></h1> <div class="admonition failure"> <p class=admonition-title>Home Assistant support is not built in to tasmota-lite.bin. Use the standard tasmota.bin or other binaries that include Home Assistant support.</p> </div> <p><a href=https://home-assistant.io/ >Home Assistant</a> is an open source home automation solution that puts local control and privacy first.</p> <p>Tasmota communicates with Home Assistant using MQTT. Before going any further, make sure MQTT is properly set up in <a href=https://www.home-assistant.io/integrations/mqtt/ >Home Assistant</a> and <a href=../MQTT/ >Tasmota</a>. </p> <p>Home Assistant has different options of adding Tasmota devices:</p> <ol> <li>Official Tasmota (beta) integration (<strong>preferred</strong>)</li> <li>MQTT discovery (<em>development halted</em>)</li> <li>Manual configuration by editing configuration.yaml</li> </ol> <h2 id=tasmota-beta-integration>Tasmota (beta) Integration<a class=headerlink href=#tasmota-beta-integration title="Permanent link">~</a></h2> <p>Once you configure the <a href=https://www.home-assistant.io/integrations/tasmota/ >Home Assistant</a> integration every new Tasmota device with <code>SetOption19 0</code> set, will be discovered automatically. </p> <p>All Tasmota devices will be listed in their own Tasmota (beta) card in <strong>Configuration - Integrations</strong> menu in Home Assistant.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Do not change the FullTopic in order to use this feature. Leave it as default.</p> </div> <p><img alt="Informative sensor" src=../_media/tasmota_integration_showcase.png></p> <p>Tasmota uses <a href=../Commands/#devicename><code>DeviceName</code></a> to name the device in Tasmota (beta) integration and <a href=../Commands/#friendlyname><code>FriendlyName&lt;x&gt;</code></a> to name power outputs (switch or light entities in HA).</p> <h3 id=supported-entities>Supported Entities<a class=headerlink href=#supported-entities title="Permanent link">~</a></h3> <ul> <li>Lights as <code>light</code> entities.<br> Single channel Dimmers, RGB lights, RGB lights with Color Temperature control and RGB lights with White control are supported.</li> <li>Relays as <code>switch</code> entities With <a href=../Commands/#setoption30><code>SetOption30 1</code></a> all relays one the device will be added as light entities instead</li> <li>Sensors as <code>sensor</code> entities</li> <li>Switches as <code>binary_sensor</code> entities or <code>automation triggers</code> depending on <code>SwitchMode</code> used when <a href=../Commands/#setoption114><code>SetOption114 1</code></a></li> <li>Buttons as automation triggers when <a href=../Commands/#setoption73><code>SetOption73</code></a> is enabled</li> <li>Shutters as cover entities. Currently only shutter modes 1 to 4 are supported. Shutter mode 5 and Tuya shutters are not supported.</li> <li>Devices configured as iFan02 or iFan03 as fan entities. Tuya fans are not supported.</li> <li>Each discovered device will by default add 8 disabled sensors. Enable the ones you need. You cannot delete them, they will simply be re-added on a restart.</li> </ul> <p>Types of devices not listed above still require <a href=##editing-configurationyaml>manual configuration</a></p> <div class="admonition warning"> <p class=admonition-title>Zigbee devices paired in Tasmota will <strong>NOT</strong> be discovered in Home Assistant</p> </div> <h3 id=transition-from-mqtt-discovery>Transition from MQTT Discovery<a class=headerlink href=#transition-from-mqtt-discovery title="Permanent link">~</a></h3> <p>If you have been using <code>SetOption19 1</code> for device discovery, setting it to <code>SetOption19 0</code> will remove your Tasmota device from the MQTT device list and add it to the Tasmota integrations in HA. They will be treated as new entities in Home Assistant but if you previously used default values they will use the same entity_id as the MQTT discovery devices.</p> <h3 id=removing-devices>Removing devices<a class=headerlink href=#removing-devices title="Permanent link">~</a></h3> <p>You cannot as long as Home Assistant support is enabled in your Tasmota binary. Disable the device in Home Assistant instead. There is no setoption to disable all autodiscovery.</p> <p><img alt="Disable device" src=../_media/hatasmota_delete.png></p> <p>Deleting them from Home Assistant while Tasmota device is still active will simply rediscover all the entities. </p> <p>If you opt to switch to MQTT Discovery, issuing <code>SetOption19 1</code> command will remove all Tasmota (beta) entities and add new entities under the MQTT integration.</p> <h2 id=editing-configurationyaml>Editing configuration.yaml<a class=headerlink href=#editing-configurationyaml title="Permanent link">~</a></h2> <p>Adding devices manually is done by editing the <code>configuration.yaml</code> file and adding appropriate blocks of yaml code to the corresponding section.</p> <div class="admonition note"> <p class=admonition-title>After every change to the configuration.yaml file you'll need to restart Home Assistant to make it aware of the changes.</p> </div> <p>The advantage of manually configuring a device is that you maintain control of all aspects of the configuration.</p> <div class="admonition warning"> <p class=admonition-title>All the configurations are just examples.</p> </div> <p>You need to be familiar with Home Assistant's configuration structure and procedures. <br> Straight copy paste of the given examples into configuration.yaml will probably not work for you. </p> <p>If you are using a localized (non-english) version be sure to check the correct spelling and cases for values:</p> <ul> <li>'payload_available' </li> <li>'payload_not_available'</li> <li>'payload_on'</li> <li>'payload_off'</li> </ul> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you want the power states to be persistent in Tasmota and Home Assistant set <code>PowerRetain 1</code> instead of using <code>retain: true</code> in Home Assistant</p> </div> <h3 id=switches>Switches<a class=headerlink href=#switches title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/switch.mqtt/ >MQTT Switch</a> integration.</p> <p><strong>Required Commands</strong> <br> <code>SetOption59 1</code> - enables sending of tele/%topic%/STATE on POWER and light related commands</p> <div class="admonition example"> <p class=admonition-title>Single Switch</p> </div> <div class=codehilite><pre><span></span><code><span class=nt>switch</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>  
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Multiple Switches</p> </div> <p>When a device has more than one relay you need to create a new switch for each relay. For each relay use corresponding POWER&lt;x> (POWER1, POWER2, etc) or if <a href=../Commands/#setoption26>SetOption26</a> is enabled)</p> <div class=codehilite><pre><span></span><code><span class=nt>switch</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>1&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>  
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER1</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER1&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>2&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>  
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER2</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER2&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>3&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>  
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER3</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER3&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Dimmer</p> </div> <p>Used for dimmers and dimmable lights (single channel lights).</p> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Dimmer&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json.POWER}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json.Dimmer}}&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you are using your device to control a light, you may want to use <a href=https://www.home-assistant.io/components/light.mqtt/ ><code>MQTT Light</code></a> integration instead. </p> </div> <p>Simply replace <code>switch:</code> with <code>light:</code> in the configuration keeping everything else the same.</p> <h3 id=lights>Lights<a class=headerlink href=#lights title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/light.mqtt/ >MQTT Light</a> integration.</p> <p>All configurations require <code>SetOption59 1</code> - enables sending of tele/%topic%/STATE on POWER and light related commands</p> <p><strong>Optional Commands</strong> <br> <code>Fade on</code> - makes transitions smoother <br> <code>Speed 5</code> - set transition speed</p> <div class="admonition example"> <p class=admonition-title>Dimmable</p> <p>Used with dimmers and dimmable only lights (single channel lights).</p> </div> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Dimmer&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB Light</p> <p>Should also be used with lights using <a href=../Lights/#white-blend-mode>White Blend Mode</a></p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;RGB</span><span class=nv> </span><span class=s>Light&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>rgb_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
    <span class=nt>rgb_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
    <span class=nt>effect_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>effect_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_list</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB+W Light</p> <p>In this configuration RGB and white cannot be on at the same time. See <a href=../Lights/#4-channels-rgbw-lights>Lights</a> for options.</p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;RGB+W</span><span class=nv> </span><span class=s>Light&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>white_value_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>white_value_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/White&quot;</span>
    <span class=nt>white_value_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>white_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.White</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>rgb_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
    <span class=nt>rgb_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
    <span class=nt>effect_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>effect_value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json.Scheme}}&quot;</span>
    <span class=nt>effect_list</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB+CCT Light</p> <p>Also called RGBWW, RGBCW or 5 channel lights</p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;RGBCCT</span><span class=nv> </span><span class=s>Light&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>color_temp_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/CT&quot;</span>
    <span class=nt>color_temp_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>color_temp_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.CT</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>rgb_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
    <span class=nt>rgb_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
    <span class=nt>effect_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>effect_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_list</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Addressable LED</p> <p>Applies only to <a href=../WS2812B-and-WS2813/ >WS281x</a> lights. </p> </div> <div class=codehilite><pre><span></span><code><span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Addressable</span><span class=nv> </span><span class=s>LED&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/STATE&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>brightness_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
    <span class=nt>brightness_state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/STATE&quot;</span>
    <span class=nt>brightness_scale</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>on_command_type</span><span class=p>:</span> <span class=s>&quot;brightness&quot;</span>
    <span class=nt>brightness_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>rgb_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
    <span class=nt>rgb_state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
    <span class=nt>effect_state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/STATE&quot;</span>
    <span class=nt>effect_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>effect_list</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">8</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">9</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">11</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">12</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB with hex values</p> </div> <p>If you don't want to use <code>SetOption17 1</code> with decimal values and use default hex values, change:</p> <div class=codehilite><pre><span></span><code><span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> <p>to</p> <div class=codehilite><pre><span></span><code>  <span class=nt>rgb_command_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>&#39;%02X%02X%02X&#39;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>format(red,</span><span class=nv> </span><span class=s>green,</span><span class=nv> </span><span class=s>blue)}}&quot;</span>
  <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>(value_json.Color[0:2]|int(base=16),value_json.Color[2:4]|int(base=16),value_json.Color[4:6]|int(base=16))</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Control RGB and White independently</p> <p>Using color picker will keep white light on. If you use the white slider RGB light will get turned off. White value and dimmer value are connected, to have more granular control you will have to <a href=../Lights/#rgb-and-white-split>split the lights</a>.</p> </div> <p>Replace </p> <div class=codehilite><pre><span></span><code><span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> <p>to</p> <div class=codehilite><pre><span></span><code>  <span class=nt>rgb_command_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>&#39;%02X%02X%02X=&#39;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>format(red,</span><span class=nv> </span><span class=s>green,</span><span class=nv> </span><span class=s>blue)}}&quot;</span>
  <span class=nt>rgb_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>(value_json.Color[0:2]|int(base=16),value_json.Color[2:4]|int(base=16),value_json.Color[4:6]|int(base=16))</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> <p>The key is the <code>=</code> after color string in hex. It will retain current white value while changing color. </p> <div class="admonition example"> <p class=admonition-title>Using schema: template light</p> <p>Thorough explanation of template: schema lights and its features on <a href=https://blakadder.com/template_schema_lights/ >https://blakadder.com/template_schema_lights/</a></p> </div> <!-- tabs:end --> <h3 id=sensors>Sensors<a class=headerlink href=#sensors title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/sensor.mqtt/ >MQTT Sensor</a> integration.</p> <p>A sensor will send its data in set intervals defined by <a href=../Commands/#teleperiod><code>TelePeriod</code></a> (default every 5 minutes).</p> <div class="admonition example"> <p class=admonition-title>Temperature</p> </div> <p>Check your sensor name in Tasmota and change accordingly. This example uses the DHT22 sensor.</p> <div class=codehilite><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Temperature&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;DHT22&#39;].Temperature</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;°C&quot;</span>  <span class=c1># &quot;F&quot; if using Fahrenheit</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">temperature</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Humidity</p> </div> <p>Check your sensor name in Tasmota and change accordingly. This example uses the DHT22 sensor.</p> <div class=codehilite><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Humidity&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;DHT22&#39;].Humidity</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;%&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">humidity</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Pressure</p> </div> <p>Check your sensor name in Tasmota and change accordingly. This example uses the BMP280 sensor.</p> <div class=codehilite><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Pressure&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.BMP280.Pressure</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;hPa&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">pressure</span>
</code></pre></div> <p>Change unit_of_measurement to <code>"mmHg"</code> if <a href=../Commands/#setoption24><code>SetOption24 1</code></a></p> <div class="admonition example"> <p class=admonition-title>Wi-Fi Signal Quality</p> </div> <p>Monitor the relative Wi-Fi signal quality of a device.</p> <div class=codehilite><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Wi-Fi</span><span class=nv> </span><span class=s>Quality&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;%&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json[&#39;Wifi&#39;].RSSI</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">signal_strength</span>
</code></pre></div> <h3 id=power-monitoring>Power Monitoring<a class=headerlink href=#power-monitoring title="Permanent link">~</a></h3> <p><img alt="Example of Lovelace UI" src=../_media/hax_pow1.png style=margin:5px;float:right;width:10em></p> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/sensor.mqtt/ >MQTT Sensor</a> integration.</p> <p>Power monitoring sensors will send their data in set intervals defined by <a href=../Commands/#teleperiod><code>TelePeriod</code></a> (default every 5 minutes).</p> <p>To get all the data in Home Assistant requires multiple sensors which you can later group to your liking in <a href=https://www.home-assistant.io/lovelace/ >Lovelace UI</a></p> <div class="admonition example"> <p class=admonition-title>Power Monitoring</p> </div> <div class=codehilite><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Energy</span><span class=nv> </span><span class=s>Today&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Today&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;kWh&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Power&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Power&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;W&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Voltage&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Voltage&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;V&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Current&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Current&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;A&quot;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>For additional sensors use "Total";"Yesterday";"Period","ApparentPower","ReactivePower";"Factor" in <code>value_template</code> string</p> </div> <p><a href="https://www.youtube.com/watch?v=ktHQrhAF8VQ">Video tutorial</a> on a power monitoring plug setup by Digiblur</p> <h3 id=binary-sensors>Binary Sensors<a class=headerlink href=#binary-sensors title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/binary_sensor.mqtt/ >MQTT Binary Sensor</a> integration.</p> <div class="admonition example"> <p class=admonition-title>PIR Sensor</p> </div> <p>Used for a configured <a href=../PIR-Motion-Sensors/ >PIR Sensor</a> and requires this rule:</p> <p><strong>Required Commands</strong></p> <div class=codehilite><pre><span></span><code><span class=go>Rule1 on Switch1#State=1 do Publish stat/hall/MOTION ON endon on Switch1#State=1 do Publish stat/hall/MOTION OFF endon</span>
<span class=go>Rule1 1</span>
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=nt>binary_sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Motion</span><span class=nv> </span><span class=s>Sensor&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/MOTION&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">motion</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Door Sensor</p> </div> <p>Requires a reed switch configured in Tasmota.</p> <p><strong>Required Commands</strong></p> <div class=codehilite><pre><span></span><code><span class=go>Rule1 on Switch1#State=1 do Publish stat/hall/MOTION ON endon on Switch1#State=1 do Publish stat/hall/MOTION OFF endon</span>
<span class=go>Rule1 1</span>
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=nt>binary_sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Motion</span><span class=nv> </span><span class=s>Sensor&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/MOTION&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">door</span>   <span class=c1># also: window, garage_door or opening</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RF Bridge</p> </div> <p>An RF door sensor configured with an RF receiver in Tasmota.</p> <div class=codehilite><pre><span></span><code><span class=nt>binary_sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;RF</span><span class=nv> </span><span class=s>bridge</span><span class=nv> </span><span class=s>rfkey&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;1&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;0&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opening</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/RESULT&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json.RfReceived.RfKey</span><span class=nv> </span><span class=s>}}&#39;</span>
</code></pre></div> <!-- tabs:end --> <h3 id=fans>Fans<a class=headerlink href=#fans title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/fan.mqtt/ >MQTT Fan</a> integration.</p> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>Fan</p> </div> <p>Derived from <a href=https://github.com/arendst/Tasmota/issues/2839>#2839</a> by @kbickar and @finity69x2</p> <div class=codehilite><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>fan</span><span class=p>:</span>
<span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>  
  <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Fan&quot;</span>
  <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/FanSpeed&quot;</span>
  <span class=nt>speed_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/FanSpeed&quot;</span>    
  <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>
  <span class=nt>speed_state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/RESULT&quot;</span>
  <span class=nt>state_value_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
    <span class=no>{% if value_json.FanSpeed is defined %}</span>
      <span class=no>{% if value_json.FanSpeed == 0 -%}0{%- elif value_json.FanSpeed &gt; 0 -%}4{%- endif %}</span>
    <span class=no>{% else %}</span>
      <span class=no>{% if states.fan.tasmota.state == &#39;off&#39; -%}0{%- elif states.fan.tasmota.state == &#39;on&#39; -%}4{%- endif %}</span>
    <span class=no>{% endif %}</span>
  <span class=nt>speed_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.FanSpeed</span><span class=nv> </span><span class=s>}}&quot;</span>
  <span class=nt>availability_topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tele/tasmota/LWT</span>
  <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;0&quot;</span>
  <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;4&quot;</span>
  <span class=nt>payload_low_speed</span><span class=p>:</span> <span class=s>&quot;1&quot;</span>
  <span class=nt>payload_medium_speed</span><span class=p>:</span> <span class=s>&quot;2&quot;</span>
  <span class=nt>payload_high_speed</span><span class=p>:</span> <span class=s>&quot;3&quot;</span>
  <span class=nt>payload_available</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Online</span>
  <span class=nt>payload_not_available</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Offline</span>
  <span class=nt>speeds</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">off</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">low</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medium</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">high</span>
</code></pre></div> <!-- tabs:end --> <h3 id=covers>Covers<a class=headerlink href=#covers title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/cover.mqtt/ >MQTT Cover</a> integration.</p> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>TuyaMCU Curtain/Shade Motor</p> </div> <p>Requires <code>SetOption66 1</code>. In this example dpId1 is for open/close/stop of the motor, dpId2 sets position and dpId3 displays the current position.</p> <div class=codehilite><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>cover</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tuya</span><span class=nv> </span><span class=s>Curtain&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/TuyaSend4&quot;</span>
    <span class=nt>payload_open</span><span class=p>:</span> <span class=s>&quot;1,0&quot;</span>
    <span class=nt>payload_close</span><span class=p>:</span> <span class=s>&quot;1,2&quot;</span>
    <span class=nt>payload_stop</span><span class=p>:</span> <span class=s>&quot;1,1&quot;</span>
    <span class=nt>position_open</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class=nt>position_closed</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>position_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/RESULT&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;-</span>
          <span class=no>{% if value_json.TuyaReceived.DpType2Id3 is defined %}</span>
          <span class=no>{{ value_json.TuyaReceived.DpType2Id3 }}</span>
          <span class=no>{% else %}  </span>
          <span class=no>{{ state_attr(&#39;cover.tuya_curtain&#39;,&#39;current_position&#39;) | int }}</span>
          <span class=no>{% endif %}  </span>
    <span class=nt>set_position_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmota/TuyaSend2&quot;</span>
    <span class=nt>set_position_template</span><span class=p>:</span> <span class=s>&#39;2,{{</span><span class=nv> </span><span class=s>position</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
</code></pre></div> <p>If you change <code>name:</code> make sure to reflect that change in the value_template cover name!</p> <!-- tabs:end --> <h3 id=device-specific>Device Specific<a class=headerlink href=#device-specific title="Permanent link">~</a></h3> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>iFan02</p> </div> <p>Combination of configs found in issue <a href=https://github.com/arendst/Tasmota/issues/2839>#2839</a> and Home Assistant forum thread <a href=https://community.home-assistant.io/t/sonoff-ifan02-tasmota-mqtt-fan/64083>Sonoff IFan02 (Tasmota) MQTT Fan</a>.</p> <div class=codehilite><pre><span></span><code><span class=nt>fan</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>  
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Pat</span><span class=nv> </span><span class=s>Ceiling</span><span class=nv> </span><span class=s>Fan&quot;</span>  
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/ifan02/RESULT&quot;</span>
    <span class=nt>speed_state_topic</span><span class=p>:</span> <span class=s>&quot;stat/ifan02/RESULT&quot;</span>
    <span class=nt>state_value_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
        <span class=no>{% if value_json.FanSpeed is defined %}</span>
          <span class=no>{% if value_json.FanSpeed == 0 -%}0{%- elif value_json.FanSpeed &gt; 0 -%}2{%- endif %}</span>
        <span class=no>{% else %}</span>
          <span class=no>{% if states.fan.pat_ceiling_fan.state == &#39;off&#39; -%}0{%- elif states.fan.pat_ceiling_fan.state == &#39;on&#39; -%}2{%- endif %}</span>
        <span class=no>{% endif %}</span>
    <span class=nt>speed_value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.FanSpeed</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tele/ifan02/LWT</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Online</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Offline</span>
    <span class=nt>speed_command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/ifan02/FanSpeed&quot;</span>
    <span class=nt>payload_low_speed</span><span class=p>:</span> <span class=s>&quot;1&quot;</span>
    <span class=nt>payload_medium_speed</span><span class=p>:</span> <span class=s>&quot;2&quot;</span>
    <span class=nt>payload_high_speed</span><span class=p>:</span> <span class=s>&quot;3&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/ifan02/FanSpeed&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;0&quot;</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;2&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>speeds</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">low</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medium</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">high</span>
<span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Pat</span><span class=nv> </span><span class=s>Ceiling</span><span class=nv> </span><span class=s>Light&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/ifan02/STATE&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/ifan02/POWER&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/ifan02/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Sonoff S31</p> </div> <p>Configure the device as Sonoff S31, and run:\ <code>SetOption4 1</code> <br> <code>SetOption59 1</code></p> <div class=codehilite><pre><span></span><code><span class=nt>switch</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>power&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/STATE&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/s31/POWER&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Voltage&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Voltage</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;V&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Current&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Current</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>round(2)</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;A&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Power&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Power</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;W&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">power</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Power</span><span class=nv> </span><span class=s>Factor&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Factor</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Energy</span><span class=nv> </span><span class=s>Today&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Today</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;kWh&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Energy</span><span class=nv> </span><span class=s>Yesterday&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Yesterday</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;kWh&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;s31</span><span class=nv> </span><span class=s>Energy</span><span class=nv> </span><span class=s>Total&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;ENERGY&#39;].Total</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>unit_of_measurement</span><span class=p>:</span> <span class=s>&quot;kWh&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/s31/LWT&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
</code></pre></div> <!-- tabs:end --> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>Covers</p> </div> <p>For shutter position to persist in Home Assistant through device reboots, execute <code>PowerRetain 1</code>.</p> <p>These sample configurations should allow the shutter work in Home Assistant. This is only an example and may need further modification to work in your environment.</p> <p>This example uses a new configuration for roller shutters with options for positioning. It assumes that <code>%prefix%/%topic%/</code> is configured in the Tasmota Full Topic MQTT parameter. </p> <div class=codehilite><pre><span></span><code><span class=nt>cover</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Balcony</span><span class=nv> </span><span class=s>Blinds&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/%topic%/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>position_topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">stat/%topic%/Shutter1</span>
    <span class=nt>position_open</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>position_closed</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class=nt>set_position_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%topic%/ShutterPosition1&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
    <span class=nt>payload_open</span><span class=p>:</span> <span class=s>&quot;ShutterOpen1&quot;</span>
    <span class=nt>payload_close</span><span class=p>:</span> <span class=s>&quot;ShutterClose1&quot;</span>
    <span class=nt>payload_stop</span><span class=p>:</span> <span class=s>&quot;ShutterStop1&quot;</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>optimistic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> <p>Check <a href=https://github.com/stefanbode/Sonoff-Tasmota/issues/130>Issue 130</a> for more information about this configuration.</p> <p>Another integration example: </p> <div class=codehilite><pre><span></span><code><span class=nt>cover</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Test&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/%topic%/LWT&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/%topic%/RESULT&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{</span><span class=nv> </span><span class=s>value</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>int</span><span class=nv> </span><span class=s>}}&#39;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>payload_open</span><span class=p>:</span> <span class=s>&quot;ShutterOpen1&quot;</span>
    <span class=nt>payload_close</span><span class=p>:</span> <span class=s>&quot;ShutterClose1&quot;</span>
    <span class=nt>payload_stop</span><span class=p>:</span> <span class=s>&quot;ShutterStop1&quot;</span>
    <span class=nt>state_open</span><span class=p>:</span> <span class=s>&quot;ON&quot;</span>
    <span class=nt>state_closed</span><span class=p>:</span> <span class=s>&quot;OFF&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>optimistic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>tilt_command_topic</span><span class=p>:</span> <span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
    <span class=nt>tilt_status_topic</span><span class=p>:</span> <span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
    <span class=nt>set_position_topic</span><span class=p>:</span> <span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
    <span class=nt>position_topic</span><span class=p>:</span> <span class=s>&quot;stat/%topic%/SHUTTER1&quot;</span>
    <span class=nt>tilt_min</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class=nt>tilt_max</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>tilt_closed_value</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class=nt>tilt_opened_value</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
</code></pre></div> <p>Integration example with position updated during movement (Tasmota versions &gt;= v8.1.0.5): </p> <div class=codehilite><pre><span></span><code><span class=nt>cover</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Balcony</span><span class=nv> </span><span class=s>Blinds&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/%topic%/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>position_topic</span><span class=p>:</span> <span class=s>&quot;stat/%topic%/RESULT&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
      <span class=no>{% if (&#39;Shutter1&#39; in value_json) and (&#39;Position&#39; in value_json.Shutter1) %}</span>
        <span class=no>{{ value_json.Shutter1.Position }}</span>
      <span class=no>{% else %}</span>
        <span class=no>{% if is_state(&#39;cover.balcony_blinds&#39;, &#39;unknown&#39;) %}</span>
          <span class=no>50</span>
        <span class=no>{% else %}</span>
          <span class=no>{{ state_attr(&#39;cover.balcony_blinds&#39;,&#39;current_position&#39;) }}</span>
        <span class=no>{% endif %}</span>
      <span class=no>{% endif %}    </span>
    <span class=nt>position_open</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class=nt>position_closed</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class=nt>set_position_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%topic%/ShutterPosition1&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
    <span class=nt>payload_open</span><span class=p>:</span> <span class=s>&quot;ShutterOpen1&quot;</span>
    <span class=nt>payload_close</span><span class=p>:</span> <span class=s>&quot;ShutterClose1&quot;</span>
    <span class=nt>payload_stop</span><span class=p>:</span> <span class=s>&quot;ShutterStop1&quot;</span>
    <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>optimistic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> <p>In addition, add to your home assistant start up automation a query for the current shutter position:</p> <div class=codehilite><pre><span></span><code><span class="p p-Indicator">-</span> <span class=nt>alias</span><span class=p>:</span> <span class=s>&quot;Power</span><span class=nv> </span><span class=s>state</span><span class=nv> </span><span class=s>on</span><span class=nv> </span><span class=s>HA</span><span class=nv> </span><span class=s>start-up&quot;</span>
  <span class=nt>trigger</span><span class=p>:</span>
    <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
    <span class=nt>event</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
  <span class=nt>action</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
      <span class=nt>data</span><span class=p>:</span>
        <span class=nt>topic</span><span class=p>:</span> <span class=s>&quot;cmnd/%shutters</span><span class=nv> </span><span class=s>grouptopic%/shutterposition&quot;</span>
        <span class=nt>payload</span><span class=p>:</span> <span class=s>&quot;&quot;</span>       
</code></pre></div> <h3 id=zigbee-devices>Zigbee Devices<a class=headerlink href=#zigbee-devices title="Permanent link">~</a></h3> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>Dimmable Light</p> </div> <p>This configuration is for a dimmable light reporting on <code>0xE1F9</code> using endpoint 1, cluster 8 for brightness. <code>ZbRead</code> part in the template is needed to always update the brightness values.</p> <div class=codehilite><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>light</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>schema</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">template</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Fire</span><span class=nv> </span><span class=s>Light&quot;</span>
    <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/zigbee-gateway/Backlog&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/zigbee-gateway/SENSOR&quot;</span>
    <span class=nt>command_on_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
        <span class=no>{%- if brightness is defined -%}</span>
        <span class=no>ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Dimmer&quot;:{{ brightness }} } }; ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Power&quot;:true} }; delay 20; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
        <span class=no>{%- else -%}</span>
        <span class=no>ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Power&quot;:true} }; delay 20; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
        <span class=no>{%- endif -%}</span>
    <span class=nt>command_off_template</span><span class=p>:</span> <span class=s>&#39;ZbSend</span><span class=nv> </span><span class=s>{</span><span class=nv> </span><span class=s>&quot;device&quot;:&quot;0xE1F9&quot;,</span><span class=nv> </span><span class=s>&quot;send&quot;:{&quot;Power&quot;:false}</span><span class=nv> </span><span class=s>};</span><span class=nv> </span><span class=s>delay</span><span class=nv> </span><span class=s>20;</span><span class=nv> </span><span class=s>ZbRead</span><span class=nv> </span><span class=s>{</span><span class=nv> </span><span class=s>&quot;device&quot;:&quot;0xE1F9&quot;,</span><span class=nv> </span><span class=s>&quot;endpoint&quot;:1,</span><span class=nv> </span><span class=s>&quot;cluster&quot;:8,</span><span class=nv> </span><span class=s>&quot;read&quot;:0</span><span class=nv> </span><span class=s>}&#39;</span>
    <span class=nt>state_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
        <span class=no>{% if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0xE1F9&#39;] is defined and value_json.ZbReceived[&#39;0xE1F9&#39;].Power is defined %}</span>
        <span class=no>{% if value_json.ZbReceived[&#39;0xE1F9&#39;].Power == true %}</span>
        <span class=no>on</span>
        <span class=no>{% else %}</span>
        <span class=no>off</span>
        <span class=no>{% endif %}</span>
        <span class=no>{% else %}</span>
        <span class=no>{{ states(&#39;light.fire_light&#39;) }}</span>
        <span class=no>{% endif %}</span>
    <span class=nt>brightness_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
        <span class=no>{%- if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0xE1F9&#39;] is defined and value_json.ZbReceived[&#39;0xE1F9&#39;].Dimmer is defined -%}</span>
        <span class=no>{{ value_json[&#39;ZbReceived&#39;][&#39;0xE1F9&#39;].Dimmer | int }}</span>
        <span class=no>{%- else -%}</span>
        <span class=no>{{ state_attr(&#39;light.fire_light&#39;, &#39;brightness&#39;) | int }}</span>
        <span class=no>{%- endif -%}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Water Leak Sensor</p> </div> <p>This specific configuration is for Xiaomi Aqara Water Leak sensor reporting on <code>0x099F</code>.</p> <div class=codehilite><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>binary_sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Water</span><span class=nv> </span><span class=s>Leak&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/zigbee-gateway/SENSOR&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class="p p-Indicator">&gt;</span>
      <span class=no>{%- if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0x099F&#39;] is defined -%}</span>
      <span class=no>{%- if value_json.ZbReceived[&#39;0x099F&#39;][&#39;0500!00&#39;] == &#39;010000FF0000&#39; -%}</span>
      <span class=no>ON</span>
      <span class=no>{% else %}</span>
      <span class=no>OFF</span>
      <span class=no>{% endif %}</span>
      <span class=no>{% else %}</span>
      <span class=no>{{ states(&#39;binary_sensor.water_leak&#39;) }}</span>
      <span class=no>{% endif %}</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/zigbee-gateway/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>device_class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">moisture</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Enable join switch</p> </div> <div class=codehilite><pre><span></span><code><span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
  <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Zigbee2Tasmota enable join</span>
  <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;tele/zigbee/RESULT&quot;</span>
  <span class=nt>command_topic</span><span class=p>:</span> <span class=s>&quot;cmnd/zigbee/ZbPermitJoin&quot;</span> 
  <span class=nt>payload_on</span><span class=p>:</span> <span class=s>&quot;1&quot;</span>
  <span class=nt>payload_off</span><span class=p>:</span> <span class=s>&quot;0&quot;</span>
  <span class=nt>state_on</span><span class=p>:</span> <span class=s>&quot;Enable</span><span class=nv> </span><span class=s>Pairing</span><span class=nv> </span><span class=s>mode</span><span class=nv> </span><span class=s>for</span><span class=nv> </span><span class=s>60</span><span class=nv> </span><span class=s>seconds&quot;</span>
  <span class=nt>state_off</span><span class=p>:</span> <span class=s>&quot;off&quot;</span>
  <span class=nt>optimistic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class=nt>retain</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class=nt>value_template</span><span class=p>:</span> <span class=s>&#39;{{value_json.ZbState.Message</span><span class=nv> </span><span class=s>}}&#39;</span>
  <span class=nt>icon</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mdi:zigbee</span>
</code></pre></div> <!-- tabs:end --> <h2 id=useful-automations>Useful Automations<a class=headerlink href=#useful-automations title="Permanent link">~</a></h2> <div class="admonition example"> <p class=admonition-title>Extended device information</p> </div> <p>Wi-Fi signal quality can be added as a parameter to any previous configuration by appending this section to the existing configuration yaml</p> <div class=codehilite><pre><span></span><code>    <span class=nt>json_attributes_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/STATE&quot;</span>
    <span class=nt>json_attributes_template</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Wifi</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>tojson</span><span class=nv> </span><span class=s>}}&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Sync Power State</p> </div> <p>When MQTT broker or Home Assistant is restarted, or there is a WiFi outage, Tasmota device states may not be synced with Home Assistant. Use this automation to keep your devices in sync, including power state, <em>immediately</em> after Home Assistant is started.</p> <div class=codehilite><pre><span></span><code><span class=nt>automation</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>id</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Sync Tasmota states</span>
    <span class=nt>alias</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Sync Tasmota states</span>
    <span class=nt>initial_state</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>trigger</span><span class=p>:</span>
      <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
      <span class=nt>event</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
    <span class=nt>action</span><span class=p>:</span>
    <span class=c1># sync state for devices with default fulltopics</span>
    <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
      <span class=nt>data</span><span class=p>:</span>
        <span class=nt>topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">cmnd/tasmotas/state</span>
        <span class=nt>payload</span><span class=p>:</span> <span class=s>&#39;&#39;</span>
    <span class=c1># sync state for pre8.2 autodiscovery devices</span>
    <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
      <span class=nt>data</span><span class=p>:</span>
        <span class=nt>topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tasmotas/cmnd/state</span>
        <span class=nt>payload</span><span class=p>:</span> <span class=s>&#39;&#39;</span>
</code></pre></div> <p>To sync a single TuyaMCU device states add this block with your %topic% to the automation. !!! bug You could use <code>tasmotas</code> but SerialSend might cause issues on other devices so proceed with caution.</p> <div class=codehilite><pre><span></span><code>    <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
      <span class=nt>data</span><span class=p>:</span>
        <span class=nt>topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">cmnd/%topic%/serialsend5</span>
        <span class=nt>payload</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">55aa0001000000</span>
</code></pre></div> <p>Sync Zigbee device states. Add this block with your %topic% and your Zigbee device name, endpoint and cluster.</p> <div class="admonition example"> <p class=admonition-title>Example for a dimmable light</p> </div> <div class=codehilite><pre><span></span><code>    <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
      <span class=nt>data</span><span class=p>:</span>
        <span class=nt>topic</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">cmnd/zigbee-gateway/Backlog</span>
        <span class=nt>payload</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:6, &quot;read&quot;:0 }; delay 5; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Report Firmware Version</p> </div> <p>Add a sensor like below for each Tasmota device whose firmware version you want to track.</p> <div class=codehilite><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>sensor</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt</span>
    <span class=nt>name</span><span class=p>:</span> <span class=s>&quot;Tasmota&quot;</span>
    <span class=nt>state_topic</span><span class=p>:</span> <span class=s>&quot;stat/tasmota/STATUS2&quot;</span>
    <span class=nt>value_template</span><span class=p>:</span> <span class=s>&quot;{{value_json[&#39;StatusFWR&#39;].Version</span><span class=nv> </span><span class=s>}}&quot;</span>
    <span class=nt>availability_topic</span><span class=p>:</span> <span class=s>&quot;tele/tasmota/LWT&quot;</span>
    <span class=nt>payload_available</span><span class=p>:</span> <span class=s>&quot;Online&quot;</span>
    <span class=nt>payload_not_available</span><span class=p>:</span> <span class=s>&quot;Offline&quot;</span>
    <span class=nt>qos</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</code></pre></div> <p>Automation to have each device report firmware version on Home Assistant reboot. <em>You can manually trigger this automation from Home Assistant UI.</em></p> <div class=codehilite><pre><span></span><code><span class=nt>automation</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>alias</span><span class=p>:</span> <span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Firmware</span><span class=nv> </span><span class=s>Version</span><span class=nv> </span><span class=s>Check&quot;</span>
    <span class=nt>trigger</span><span class=p>:</span>
      <span class=nt>platform</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
      <span class=nt>event</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
    <span class=nt>action</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>service</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
        <span class=nt>data</span><span class=p>:</span>
          <span class=nt>topic</span><span class=p>:</span> <span class=s>&quot;cmnd/tasmotas/STATUS&quot;</span>
          <span class=nt>payload</span><span class=p>:</span> <span class=s>&quot;2&quot;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you want all your devices to switch to autodiscovery method go through Developer tools - MQTT by publishing to grouptopic <code>cmnd/tasmotas/SetOption19</code> with payload <code>1</code></p> </div> <p><img alt src=https://cdn.pbrd.co/images/HY47i1b.jpg></p> <h2 id=mqtt-discovery>MQTT Discovery<a class=headerlink href=#mqtt-discovery title="Permanent link">~</a></h2> <div class="admonition warning"> <p class=admonition-title>Development of this component is halted in favor of Tasmota (beta) integration</p> </div> <p>Home Assistant has a feature called <a href=https://www.home-assistant.io/docs/mqtt/discovery/ >MQTT discovery</a>. With MQTT discovery no user interaction or configuration file editing is needed to add new devices in Home Assistant. Most of the changes will be updated in HA automatically.</p> <h3 id=enable-autodiscovery>Enable Autodiscovery<a class=headerlink href=#enable-autodiscovery title="Permanent link">~</a></h3> <p>Enable autodiscovery on a device with the command:</p> <div class=codehilite><pre><span></span><code><span class=go>SetOption19 1</span>
</code></pre></div> <p>After the automatic discovery feature is enabled a retained MQTT message starting with topic "homeassistant/" is sent to the broker. That message contains your device configuration which will be picked up and used by Home Assistant to automatically add your device to MQTT integrations. </p> <p>Tasmota uses <a href=../Commands/#devicename><code>DeviceName</code></a> to identify the device in Home Assistant MQTT integration and <a href=../Commands/#friendlyname><code>FriendlyName&lt;x&gt;</code></a> to identify power outputs (switch or light entities in HA).</p> <div class="admonition note"> <p class=admonition-title>When changing some settings you might need a reboot or use <code>SetOption19 1</code> again to see the new changes under Home Assistant.</p> </div> <div class="admonition note"> <p class=admonition-title>Special settings for each device type:</p> </div> <h3 id=finalising-setup>Finalising Setup<a class=headerlink href=#finalising-setup title="Permanent link">~</a></h3> <p>All automatically discovered entities will show up under <strong>Configuration -&gt; Integrations -&gt; MQTT</strong> card.</p> <p>The entities are grouped under a device defined by DeviceName and identified by Tasmota as the "manufacturer": <img alt=Integration src=../_media/hass_integrations_screen.jpg></p> <p>Overview of a Tasmota device in Home Assistant integration compared to <strong>Configuration -&gt; Configure Other</strong>:</p> <p><img alt="Device layout" src=../_media/hass_1.jpg><img alt="Device layout" src=../_media/hass_0.jpg></p> <p>For every device an informative sensor will be created automatically:</p> <p><img alt="Informative sensor" src=../_media/hass_information_sensor.jpg></p> <div class="admonition warning"> <p class=admonition-title>This sensor will update on <code>TelePeriod</code> which is 5 minutes by default</p> <p>It will show as "Unavailable" until the first TelePeriod MQTT message</p> </div> <p>You can further customise your device in Home Assistant by clicking on the entity name.</p> <div class="admonition note"> <p class=admonition-title>Enabling discovery will automatically change some SetOptions to suit the new configuration</p> </div> <p><strong><code>SetOption4</code> to <code>0</code></strong>: Return MQTT response always as <code>RESULT</code> and not as %COMMAND% topic</p> <p><strong><code>SetOption17</code> to <code>1</code></strong>: Show Color as a comma-separated decimal string instead of hexadecimal</p> <p><strong><code>SetOption59</code> to <code>1</code></strong>: Send <code>tele/%topic%/STATE</code> in addition to <code>stat/%topic%/RESULT</code> for commands <code>State</code>, <code>Power</code> and any command causing a light to be turned on.</p> <h3 id=supported-entities_1>Supported Entities<a class=headerlink href=#supported-entities_1 title="Permanent link">~</a></h3> <div class=tabbed-set data-tabs=1:5><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Buttons</label><div class=tabbed-content> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/docs/automation/trigger/ >Automation Trigger</a>.</p> <p>To have buttons discovered <a href=../Commands/#setoption73><code>SetOption73</code></a> must be set to <code>1</code> and it will automatically start to listen and publish using <code>/stat/%topic%/BUTTON&lt;x&gt;T</code> topic.</p> <p>Discovery will follow all the possible combinations made using SetOption1, SetOption11 and Setoption13.</p> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Lights</label><div class=tabbed-content> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/light.mqtt/ >MQTT Light</a>.</p> <p>Discovery supports single channel Dimmer as well as multi-channel RGB, RGBW, RGBCCT and CCT lights.</p> <p>To have multi-channel PWM instead of a single light entity under Home Assistant use <a href=../Commands/#setoption68><code>SetOption68 1</code></a>.</p> <p>If you have a light with 4 or 5 channels (RGB+W or RGB+CCT) you can <a href=../Lights/#rgb-and-white-split>split them</a> into two separate lights, first one for RGB and second for White/CT. </p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Tasmota will no longer switch <code>%prefix%</code> and <code>%topic%</code> and will keep the default topic structure. This could lead to a very long topic for a light and autodiscovery could fail to parse the necessary code for Home Assistant. In this case a warning will be shown in the logs and Tasmota Console. To avoid this issue keep your <a href=../Commands/#topic>Topic</a> and/or <a href=../Commands/#friendlyname>FriendlyName</a> as short as possible.</p> </div> <p><em>Alternatively you can configure it manually using <a href=https://www.home-assistant.io/integrations/light/ >Light</a> integration.</em></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Pay attention to the order of the relays when used in conjunction with lights. The relays have priority over the lights, an incorrect order could lead to an erroneous light control. Add them starting from relay1. Entities for relays and lights will not be available in Home Assistant until the configuration will be updated.</p> </div> </div> <input id=__tabbed_1_3 name=__tabbed_1 type=radio><label for=__tabbed_1_3>Relays</label><div class=tabbed-content> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/switch.mqtt/ >MQTT Switch</a>.</p> <p>To make a relay discovered as "light" in Home Assistant use command <a href=../Commands/#setoption30><code>SetOption30 1</code></a> </p> <p><em>Alternatively you can configure it manually using <a href=https://www.home-assistant.io/components/light.switch/ >Light Switch</a> integration.</em></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Pay attention to the order of the relays when used in conjunction with lights. The relays have priority over the lights, an incorrect order could lead to an erroneous light control. Add them starting from relay1. Entities for relays and lights will not be available in Home Assistant until the configuration will be updated.</p> </div> </div> <input id=__tabbed_1_4 name=__tabbed_1 type=radio><label for=__tabbed_1_4>Sensors</label><div class=tabbed-content> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/sensor.mqtt/ >MQTT Sensor</a>.</p> <p>When discovery is enabled Tasmota will send all the sensors information to Home Assistant. For each sensor present, entities will be created in numbers equal to the items present below him.</p> <p>Example: <br> An AM2301 sensor will generate one entity for Temperature, one for Humidity and one for Dew point. </p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Please be advised that not all sensors can be correctly rendered under Home Assistant. In those cases a fallback function will be used to create a generic sensor and the correct operation is not guaranteed.</p> </div> </div> <input id=__tabbed_1_5 name=__tabbed_1 type=radio><label for=__tabbed_1_5>Switches</label><div class=tabbed-content> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/binary_sensor.mqtt/ >MQTT Binary Sensor</a> and/or as an <a href=https://www.home-assistant.io/docs/automation/trigger/ >Automation Trigger</a>.</p> <p>To have switches discovered <code>SwitchTopic</code> must be set to a custom name and it will automatically start to listen and publish using <code>stat/%topic%/SWITCH&lt;x&gt;</code> (binary sensor) or <code>stat/%topic%/SWITCH&lt;x&gt;T</code> (trigger) topics.</p> <p>Depending by the <code>SwitchMode</code>used, a switch can be a Trigger (<code>TOGGLE</code>or <code>HOLD</code>), a Binary Sensor (<code>ON</code>/<code>OFF</code>) or both at the same time.</p> <p>Example:<br> When using with <code>SwitchMode 0</code> Tasmota will create just one Trigger for <code>TOGGLE</code>.<br> When using with <code>SwitchMode 1</code> Tasmota will create a <code>Binary Sensor</code> with <code>ON</code> and <code>OFF</code> Payloads.<br> When using with <code>Switchmode 5</code> Tasmota will create a <code>Binary Sensor</code> with <code>ON</code> and <code>OFF</code> Payloads and a Trigger for <code>TOGGLE</code>. </p> <p>All switchmodes are supported with the sole exception of <code>SwitchMode11</code> and <code>SwitchMode12</code> able to generate just a <code>TOGGLE</code> trigger.</p> <p><strong>When a switch is set to a different topic than <code>0</code> is not possible to use <code>Switch#State</code> as a trigger for rules.</strong></p> </div> </div> <p>Types of devices not listed above (covers, etc) require <a href=#configuration.yaml-editing>manual configuration</a></p> <h3 id=disabling>Disabling<a class=headerlink href=#disabling title="Permanent link">~</a></h3> <p>To disable MQTT discovery and remove the retained message, execute <code>SetOption19 0</code>.<br> The "homeassistant/" topic is removed from Home Assistant and MQTT broker. Changed setoptions will not revert to defaults!</p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">~</a></h2> <p>Test if Tasmota and Home Assistant can communicate properly. </p> <p>In Home Assistant web UI go to <strong>Configuration - Integrations</strong>, locate MQTT broker card and click on <strong>CONFIGURE</strong>. Subscribe to <code>tele/%topic%/STATE</code> and click <strong>START LISTENING</strong>. You should see a JSON response from your device inside 5 minutes.</p> <p>To test control of a relay or light, as <strong>Publish a packet topic</strong> enter <code>cmnd/%topic%/POWER</code> with payload <code>toggle</code>. When you click <strong>PUBLISH</strong> your device should switch state and a JSON resc <img alt src=../_media/hass1.png> <img alt src=../_media/hass2.png></p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../Domoticz/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Domoticz </div> </div> </a> <a href=../Homebridge/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Homebridge </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://discord.gg/Ks2Kzd4 target=_blank rel=noopener title=discord.gg class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"/></svg> </a> <a href=https://t.me/tasmota target=_blank rel=noopener title=t.me class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg> </a> <a href=https://github.com/tasmota target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.18f0862e.min.js></script> <script src=../assets/javascripts/bundle.994580cf.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "..",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>